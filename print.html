<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Substrate Devops Guide</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="deployments/index.html"><strong aria-hidden="true">2.</strong> Deployment Options</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="deployments/types.html"><strong aria-hidden="true">2.1.</strong> Role Types</a></li><li class="chapter-item expanded "><a href="deployments/targets.html"><strong aria-hidden="true">2.2.</strong> Remote Targets</a></li><li class="chapter-item expanded "><a href="deployments/options.html"><strong aria-hidden="true">2.3.</strong> Role Specific Arguments</a></li></ol></li><li class="chapter-item expanded "><a href="serverdeploy/index.html"><strong aria-hidden="true">3.</strong> Server Deployments</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="serverdeploy/systemd.html"><strong aria-hidden="true">3.1.</strong> Systemd</a></li><li class="chapter-item expanded "><a href="serverdeploy/logging.html"><strong aria-hidden="true">3.2.</strong> Logging</a></li><li class="chapter-item expanded "><a href="serverdeploy/automation.html"><strong aria-hidden="true">3.3.</strong> Automation</a></li></ol></li><li class="chapter-item expanded "><a href="kubernetes/index.html"><strong aria-hidden="true">4.</strong> Kubernetes Deployments</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="kubernetes/helm.html"><strong aria-hidden="true">4.1.</strong> Helm Chart</a></li><li class="chapter-item expanded "><a href="kubernetes/testnetmanager.html"><strong aria-hidden="true">4.2.</strong> Testnet Manager</a></li></ol></li><li class="chapter-item expanded "><a href="monitoring/index.html"><strong aria-hidden="true">5.</strong> Monitoring</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="monitoring/example.html"><strong aria-hidden="true">5.1.</strong> Example Monitoring Stack</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="monitoring/prometheus.html"><strong aria-hidden="true">5.1.1.</strong> Prometheus</a></li><li class="chapter-item expanded "><a href="monitoring/grafana.html"><strong aria-hidden="true">5.1.2.</strong> Grafana</a></li><li class="chapter-item expanded "><a href="monitoring/alertmanager.html"><strong aria-hidden="true">5.1.3.</strong> Alertmanager</a></li><li class="chapter-item expanded "><a href="monitoring/loki.html"><strong aria-hidden="true">5.1.4.</strong> Loki</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="keys_accounts.html"><strong aria-hidden="true">6.</strong> Keys And Accounts</a></li><li class="chapter-item expanded "><a href="customchain.html"><strong aria-hidden="true">7.</strong> Custom Relay/Solo Chain</a></li><li class="chapter-item expanded "><a href="tooling.html"><strong aria-hidden="true">8.</strong> ü•º Infrastructure Tooling</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Examples</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="examples/polkadotjstools.html"><strong aria-hidden="true">9.1.</strong> Polkadot JS CLI Tools</a></li><li class="chapter-item expanded "><a href="examples/helmfile.html"><strong aria-hidden="true">9.2.</strong> Helmfile</a></li><li class="chapter-item expanded "><a href="examples/zombienet.html"><strong aria-hidden="true">9.3.</strong> Zombienet</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Substrate Devops Guide</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>This document has been written for two main functions. First to provide a clear overview of the existing setup. The second is to provide some guidance on agreeing the CI strategy moving forward.</p>
<h2 id="general-approach-to-infrastructure"><a class="header" href="#general-approach-to-infrastructure">General Approach to Infrastructure</a></h2>
<p>It is highly recommended that projects deploying networks have an infrastructure as code mindset. The infrastructure components in deployments should be written in code and put in a version control system.</p>
<p>This ensures that:</p>
<ul>
<li>Your Infrastructure is in a known state</li>
<li>Version control is available to see changes and enforce reviews etc..</li>
<li>Rolling back is made very easy</li>
<li>There are no manual actions required to redeploy</li>
</ul>
<p><img src="images/3osxC7.png" alt="workflow" /></p>
<h2 id="general-approach-to-security"><a class="header" href="#general-approach-to-security">General Approach to Security</a></h2>
<p>One of the main desired properties of a blockchain is security, so having a very ‚Äòsecure by default‚Äô approach to your infrastructure should always be in the forefront of your mind when deploying new networks.</p>
<p>On the infrastructure side, having strict rules and blocking any non-required communication is just a starting point. Other things that should be considered are things like log monitoring, bastion hosts being required for access, 2FA for ssh etc‚Ä¶</p>
<p>On the chain operations side, there are two very useful concepts to increase your security.</p>
<p>First is using cold / warm / hot keys, so that the compromise of say a session key would not lead to any funds being stolen. Also using multi-sig accounts on offline devices can greatly help security and also give an on-chain audit trail of all actions, allows for alerting for any onchain actions etc..</p>
<p><img src="images/AEEVr6.png" alt="key stages" /></p>
<p>Proxy accounts also let you limit the permission that an account or multisig account has on a particular target account (e.g. only staking functions can be executed by the staking controller multisig account and require 3 of 5 people to approve).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deployments"><a class="header" href="#deployments">Deployments</a></h1>
<p>This section describes the various types of deployments and options used for each.</p>
<ul>
<li>
<p><a href="deployments/./deployments/types.html">Role Types</a> lists the type of role a node can be (e.g. validator, full node etc..)</p>
</li>
<li>
<p><a href="deployments/./deployments/targets.html">Remote Targets</a> describes the type of remote host you can deploy to (e.g. VM or Kubernetes)</p>
</li>
<li>
<p><a href="deployments/./deployments/options.html">Role Specific Arguments</a> lists specific options to be used for each node type</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="node-types"><a class="header" href="#node-types">Node Types</a></h2>
<p>A non exhaustive list of some common node types:</p>
<table><thead><tr><th>Type</th><th>Function</th></tr></thead><tbody>
<tr><td>Validator</td><td>Secures the Relay Chain by staking DOT, validating proofs from collators on parachains and voting on consensus along with other validators.</td></tr>
<tr><td>Collator</td><td>Maintains a parachain by collecting parachain transactions and producing state transition proofs for the validators.</td></tr>
<tr><td>Bootnode</td><td>A node with a static address and p2p public key, used to bootstrap a node onto the network‚Äôs distributed hash table and find peers.</td></tr>
<tr><td>RPC Node</td><td>Expose an RPC interface over http or websocket for the relay chain or parachain and allow users to read the blockchain state and submit transactions (extrinsics). There are often multiple RPC nodes behind a load balancer.</td></tr>
<tr><td>Archive Node</td><td>A node which is syncing to the relay chain or parachain and has a complete database starting all the way from the genesis block.</td></tr>
<tr><td>Full Node</td><td>A node which is syncing the relay chain or parachain to the current best block.</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h2 id="deployment-targets"><a class="header" href="#deployment-targets">Deployment Targets</a></h2>
<p>A non exhaustive list of some common deployment targets:</p>
<table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Physical Server</td><td>Usually a rack mounted server sitting in a data center.</td></tr>
<tr><td>Virtual Machine</td><td>A virtual machine hosted by one of many cloud providers or self hosted onsite.</td></tr>
<tr><td>Kubernetes</td><td>A container orchestration engine to host your blockchain instances. This option is only recommended if you already have prior experience with kubernetes, especially in production environments.</td></tr>
<tr><td>Local Container</td><td>An instance running on a local container engine (e.g. containerd, docker, podman).</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h2 id="special-options-per-host-type"><a class="header" href="#special-options-per-host-type">Special Options Per Host Type</a></h2>
<table><thead><tr><th>Type</th><th>Function</th></tr></thead><tbody>
<tr><td>Validator</td><td>Should at least be running with the <code>--validator</code> flag to enable block validation. Also keys should have been injected or the RPC <code>author_rotateKeys</code> called.</td></tr>
<tr><td>Collator</td><td>Should at least be running with the <code>--collator</code> flag to enable parachain collation.</td></tr>
<tr><td>Bootnode</td><td>A node with a static key file so the p2p public address is always the same. Store this private key in a file and use the option: <code>--node-key-file /path/to/file</code></td></tr>
<tr><td>RPC Node</td><td>Use these options to allow 5000 public RPC/WS connections: <code>--unsafe-ws-external --rpc-methods Safe --rpc-cors ‚Äò*‚Äô  --ws-max-connections 5000</code></td></tr>
<tr><td>Archive Node</td><td>Use <code>-‚Äìpruning=archive</code> to not prune any block history</td></tr>
<tr><td>Full Node</td><td>N/A</td></tr>
</tbody></table>
<h2 id="parachain-specifics"><a class="header" href="#parachain-specifics">Parachain Specifics</a></h2>
<p>When running a parachain then you will need two sets of arguments, one for the relay chain and one for the parachain. Used in the format:</p>
<pre><code>./statemine $PARACHAIN_OPTIONS -- $RELAYCHAIN_OPTIONS
</code></pre>
<p>A real life example of this while executing as a statemine collator would be:</p>
<pre><code>./statemine  --chain statemine --in-peers 25 --out-peers 25 --db-cache 512 --pruning=1000 --unsafe-pruning -- --chain kusama -db-cache 512 --pruning=1000 --wasm-execution Compiled
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="server-deployments"><a class="header" href="#server-deployments">Server Deployments</a></h1>
<ul>
<li>
<p><a href="serverdeploy/./serverdeploy/systemd.html">Systemd</a> describes options for running a node and various systemd specific options.</p>
</li>
<li>
<p><a href="serverdeploy/./serverdeploy/logging.html">Logging</a> shows some common local and remote logging configurations.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemd"><a class="header" href="#systemd">Systemd</a></h1>
<h3 id="overview-1"><a class="header" href="#overview-1">Overview</a></h3>
<p>Systemd is a common way to manage services on linux hosts. It can ensure the process is enabled and running, allows you to set a policy for restarts and also set the user running the host, limit the memory usage etc..</p>
<p>It can also use an environment variable file which can help abstract the variables into it's own file per server.</p>
<h3 id="simple-example"><a class="header" href="#simple-example">Simple Example</a></h3>
<p>A simple example running a local dev chain as Alice, assuming the username is called polkadot would look like:</p>
<pre><code class="language-yaml">[Unit]
Description=Polkadot Validator

[Service]
User=polkadot
ExecStart=/home/polkadot/polkadot  --dev --alice
Restart=always
RestartSec=90

[Install]
WantedBy=multi-user.target
</code></pre>
<p>This file should be placed in /etc/systemd/system/polkadot.service and then enabled with <code>systemctl enable polkadot</code> then <code>systemctl start polkadot</code> to start the service.</p>
<h3 id="using-environment-varible-files"><a class="header" href="#using-environment-varible-files">Using Environment Varible Files</a></h3>
<p>If we want to remove some options from the systemd file itself (e.g. <code>--dev --alice</code>) and put them in an environment variable file then the systemd service would now look like:</p>
<pre><code class="language-yaml">[Unit]
Description=Polkadot Validator

[Service]
User=polkadot
EnvironmentFile=/etc/default/polkadot
ExecStart=/home/polkadot/polkadot  $START_OPTIONS
Restart=always
RestartSec=90

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Then you would need to create a file in /etc/default/polkadot which looks like:</p>
<pre><code>START_OPTIONS=&quot;--dev --alice&quot;
</code></pre>
<p>You can do this with multiple variables to abstract the configuration from the systemd file running on your hosts.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logging"><a class="header" href="#logging">Logging</a></h1>
<h3 id="local-logging"><a class="header" href="#local-logging">Local Logging</a></h3>
<p>By default output from your systemd service will go to local syslog. This will mean it ends up in a place like <code>/var/log/syslog</code> or <code>/var/log/messages</code></p>
<p>You can also view these using the <code>journalctl</code> command. To tail the current output of the polkadot process run:</p>
<pre><code>journalctl -u polkadot -f
</code></pre>
<p>It is also possible to remove old logs (say older than two days ago) using a command:</p>
<pre><code>journalctl -u polkadot --vacuum-time=2d
</code></pre>
<p>Or to retain only the past 1G of data run:</p>
<pre><code>journalctl --vacuum-size=1G
</code></pre>
<h2 id="remote-logging"><a class="header" href="#remote-logging">Remote Logging</a></h2>
<p>In a setup with many hosts you will want to aggregate the logs at a central point, some common options include Loki or Elasticsearch. </p>
<h3 id="loki"><a class="header" href="#loki">Loki</a></h3>
<p>To log to a remote loki instance you need to install the <code>promtail</code> package. An example configuration file to send logs to a remote host:</p>
<pre><code class="language-yaml"># promtail server config
server:
  http_listen_port: 9080
  grpc_listen_port: 0
  log_level: info
positions:
  filename: /var/lib/promtail/positions.yaml

# loki servers
clients:
  - url: http://myloki.mycompany.com/loki/api/v1/push
    backoff_config:
      min_period: 1m
      max_period: 1h
      max_retries: 10000
scrape_configs:
  - job_name: journald
    journal:
      max_age: 1m
      path: /var/log/journal
      labels:
        job: journald
    pipeline_stages:
      - match:
          selector: '{job=&quot;journald&quot;}'
          stages:
          - multiline:
              firstline: '^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}'
              max_lines: 2500
          - regex:
              expression: '(?P&lt;date&gt;\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3})\s+(?P&lt;level&gt;(TRACE|DEBUG|INFO|WARN|ERROR))\s+(?P&lt;worker&gt;([^\s]+))\s+(?P&lt;target&gt;[\w-]+):?:?(?P&lt;subtarget&gt;[\w-]+)?:[\s]?(?P&lt;chaintype&gt;\[[\w-]+\]+)?[\s]?(?P&lt;message&gt;.+)'
          - labels:
              level:
              target:
              subtarget:
</code></pre>
<h3 id="elasticsearch"><a class="header" href="#elasticsearch">Elasticsearch</a></h3>
<p>To log to a remote elasticsearch cluster you need to install the <code>logstash</code> package. An example configuration would look like:</p>
<pre><code class="language-yaml">nput {
     journald {
       path      =&gt; &quot;/var/log/journal&quot;
       seekto =&gt; &quot;tail&quot;
       thisboot =&gt; true
       filter    =&gt; {
           &quot;_SYSTEMD_UNIT&quot; =&gt; &quot;polkadot.service&quot;
       }
       type =&gt; &quot;systemd&quot;
     }
}


filter {
date {
     match =&gt; [&quot;timestamp&quot;, &quot;YYYY-mm-dd HH:MM:ss.SSS&quot;]
     target =&gt; &quot;@timestamp&quot;
  }
  mutate {
    rename =&gt; [ &quot;MESSAGE&quot;, &quot;message&quot; ]
    remove_field =&gt; [ &quot;cursor&quot;, &quot;PRIORITY&quot;, &quot;SYSLOG_FACILITY&quot;, &quot;SYSLOG_IDENTIFIER&quot;, &quot;_BOOT_ID&quot;, &quot;_CAP_EFFECTIVE&quot;, &quot;_CMDLINE&quot;, &quot;_COMM&quot;, &quot;_EXE&quot;, &quot;_GID&quot;, &quot;_HOSTNAME&quot;, &quot;_MACHINE_ID&quot;, &quot;_PID&quot;, &quot;_SELINUX_CONTEXT&quot;, &quot;_STREAM_ID&quot;, &quot;_SYSTEMD_CGROUP&quot;, &quot;_SYSTEMD_INVOCATION_ID&quot;, &quot;_SYSTEMD_SLICE&quot;, &quot;_SYSTEMD_UNIT&quot;, &quot;_TRANSPORT&quot;, &quot;_UID&quot; ]
  }
  if ([message] =~ &quot;.*TRACE .*&quot;) { drop{ } }
  grok {
     match =&gt; { &quot;message&quot; =&gt; &quot;%{NOTSPACE:thread} %{LOGLEVEL:log-level} %{NOTSPACE:namespace} %{GREEDYDATA:message}&quot; }
   }
}

output {
   elasticsearch {
     hosts =&gt; [&quot;https://myelasticsearch.mycompany.com:9243&quot;]
     user =&gt; &quot;username&quot;
     password =&gt; &quot;password&quot;
     index =&gt; &quot;logstash-polkadot-%{+YYYY.MM.dd}&quot;
   }
}
</code></pre>
<h2 id="logging-options"><a class="header" href="#logging-options">Logging Options</a></h2>
<p>Logging output from any substrate based changes has many log levels and targets.  All targets are set to <code>info</code> logging by default. You can adjust individual log levels using the <code>--log (-l short)</code> option, for example <code>-l afg=trace,sync=debug</code> or globally with <code>-ldebug</code>.</p>
<p>Levels:</p>
<ul>
<li>error</li>
<li>warn</li>
<li>info</li>
<li>debug</li>
<li>trace</li>
</ul>
<p>Targets:</p>
<ul>
<li>afg</li>
<li>aura</li>
<li>babe</li>
<li>beefy</li>
<li>db</li>
<li>gossip</li>
<li>header</li>
<li>peerset</li>
<li>pow</li>
<li>rpc</li>
<li>runtime</li>
<li>runtime::contracts</li>
<li>sc_offchain</li>
<li>slots</li>
<li>state-db</li>
<li>state_tracing</li>
<li>sub-libp2p</li>
<li>sync</li>
<li>telemetry</li>
<li>tracing</li>
<li>trie</li>
<li>txpool</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="automation"><a class="header" href="#automation">Automation</a></h1>
<h2 id="cloud-provisioning"><a class="header" href="#cloud-provisioning">Cloud Provisioning</a></h2>
<p>There are multiple options to provision cloud resources, which can either be provider specific and some tools are more cloud agnostic.</p>
<h3 id="popular-cloud-provider-specific-deployment-tooling"><a class="header" href="#popular-cloud-provider-specific-deployment-tooling">Popular Cloud Provider Specific Deployment Tooling:</a></h3>
<ul>
<li><a href="https://aws.amazon.com/cloudformation/">Amazon Cloud Formation</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/overview">Azure Resource Manager</a></li>
<li><a href="https://cloud.google.com/deployment-manager/docs">Google Cloud Deployment</a></li>
</ul>
<p>These vendor specific deployment tools are easy to use, have great examples and support. However when using multiple providers with custom scripting formats, making a basic to your infrastructure can require changes to multiple sections of code, for each provider to do the same thing (e.g. open a port on a host).</p>
<p>A more general solution where a change can be specified once and be used with multiple providers is using Terraform. Which currently has <a href="https://registry.terraform.io/browse/providers">more than</a> 2000 providers supported.</p>
<h2 id="terraform"><a class="header" href="#terraform">Terraform</a></h2>
<p><a href="https://www.terraform.io/">Terraform</a> is a very commonly used tool for creating all sorts of cloud resources. It supports many different providers along with having excellent modules for the main three providers (AWS, Azure, GCP). Many projects rely on this for their infrastructure deployments. </p>
<p>It uses HashiCorp‚Äôs <a href="https://www.terraform.io/language">HashiCorp Configuration Language</a>, which makes it very easy to abstract configuration, avoid the reuse of code and enables you to plug modules together easily (e.g. RPC nodes along with a frontend load balancer).</p>
<p>The code is also easy to read and should be in version control. Multiple environments can be defined so you can ensure you are using the same code on dev / test / production.</p>
<p>Two ways to preconfigure your host after deployment using terraform directly is to either:</p>
<ul>
<li>Use a pre-packaged image with all of your software (e.g. packer or similar tooling)</li>
<li>Use a cloud-init script to execute a certain script to preconfigure your base image</li>
</ul>
<p>Some examples of using terraform with multiple providers can be found in the W3F‚Äôs polkadot-validator-setup github repo. </p>
<p>Click here for a list of <a href="https://registry.terraform.io/browse/providers">terraform providers</a>.</p>
<h3 id="host-maintenance"><a class="header" href="#host-maintenance">Host Maintenance</a></h3>
<p>Once your hosts are deployed you will need to configure the hosts and install the required software, configuration files etc‚Ä¶As mentioned this can be done in a few ways using terraform itself, however another very flexible way of configuring hosts is using ansible.</p>
<table><thead><tr><th>Component</th><th>Description</th></tr></thead><tbody>
<tr><td>Playbook</td><td>Playbooks are the language by which Ansible orchestrates, configures, administers, or deploys systems</td></tr>
<tr><td>Role</td><td>Roles are units of organization in Ansible. Assigning a role to a group of hosts (or a set of groups, or host patterns, and so on) implies that they should implement a specific behavior</td></tr>
</tbody></table>
<p>When deploying our blockchain nodes, we will need an inventory which contains a list of our hosts and the groups they are in (e.g. validator, collator, rpc) and maybe some secrets which can be encrypted inline within the inventory using <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">ansible vault</a>. We will then call a playbook which links hosts/groups in the inventory with roles to execute on each host.</p>
<p>Some examples of using ansible can be found in the paritytech's <a href="https://github.com/paritytech/ansible-galaxy">ansible-galaxy</a> github repo. Specifically the node role.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kubernetes"><a class="header" href="#kubernetes">Kubernetes</a></h1>
<p>As previously mentioned, kubernetes deployments are only recommended for people with good prior operating experience of kubernetes. </p>
<p>The management of substrate/polkadot based nodes in kubernetes is made very easy with:</p>
<ul>
<li>
<p><a href="kubernetes/./kubernetes/helm.html">Parity Helm Chart</a> a helm chart to deploy all types of nodes to kubernetes</p>
</li>
<li>
<p><a href="kubernetes/./helm/testnetmanager.html">Testnet Manager</a> a powerful tool for deploying and maintaining test networks in kubernetes.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="helm-chart"><a class="header" href="#helm-chart">Helm Chart</a></h1>
<h1 id="overview-2"><a class="header" href="#overview-2">Overview</a></h1>
<p>Parity maintain a helm github repo @ <a href="https://github.com/paritytech/helm-charts">https://github.com/paritytech/helm-charts</a> - Inside this repo is the <a href="https://github.com/paritytech/helm-charts/tree/main/charts/node">node</a> chart which should be used for deploying your substate/polkadot binary. </p>
<p>All variables are documented clearly in the <a href="https://github.com/paritytech/helm-charts/blob/main/charts/node/README.md">README.md</a> and there‚Äôs an example <a href="https://github.com/paritytech/helm-charts/blob/main/charts/node/values.yaml">values.yml</a> which you can start working from.</p>
<h2 id="example-rococo-local-chain"><a class="header" href="#example-rococo-local-chain">Example Rococo Local Chain</a></h2>
<p>This is a simple example of deploying a <code>rococo-local</code> test chain in kubernetes. Two validators and two full nodes will be deployed via the helm chart. Once both validators are running you will see block production. A custom node key is used on the <code>Alice</code> validator which all other hosts use as a bootnode. </p>
<h3 id="first-install-the-helm-repo"><a class="header" href="#first-install-the-helm-repo">First install the helm repo:</a></h3>
<pre><code>helm repo add parity https://paritytech.github.io/helm-charts/
helm install polkadot-node parity/node
</code></pre>
<h3 id="deploy-validator-alice"><a class="header" href="#deploy-validator-alice">Deploy Validator Alice:</a></h3>
<p>Alice will be deployed in a statefulset and use an example custom node key, along with deploying a service to be used as a bootnode:</p>
<pre><code>helm install rococo-alice parity/node --set node.role=&quot;validator&quot; --set node.customNodeKey=&quot;91cb59d86820419075b08e3043cd802ba3506388d8b161d2d4acd203af5194c1&quot; --set node.chain=rococo-local --set node.perNodeServices.relayP2pService.enabled=true --set node.perNodeServices.relayP2pService.port=30333 --set node.flags=&quot;--alice --rpc-external --ws-external --rpc-cors all --rpc-methods=unsafe&quot;
</code></pre>
<h3 id="deploy-validator-bob"><a class="header" href="#deploy-validator-bob">Deploy Validator Bob:</a></h3>
<pre><code>helm install rococo-bob parity/node --set node.role=&quot;validator&quot; --set node.chain=rococo-local --set node.flags=&quot;--bob --bootnodes '/dns4/rococo-alice-node-0-relay-chain-p2p/tcp/30333/p2p/12D3KooWMeR4iQLRBNq87ViDf9W7f6cc9ydAPJgmq48rAH116WoC'&quot;
</code></pre>
<h3 id="deploy-two-full-nodes"><a class="header" href="#deploy-two-full-nodes">Deploy Two Full Nodes:</a></h3>
<pre><code>helm install rococo-pool parity/node --set node.chain=rococo-local --set node.replicas=2 --set node.flags=&quot;--bootnodes '/dns4/rococo-alice-node-0-relay-chain-p2p/tcp/30333/p2p/12D3KooWMeR4iQLRBNq87ViDf9W7f6cc9ydAPJgmq48rAH116WoC'&quot;
</code></pre>
<p>Once these steps are complete you will have a working <code>rococo-local</code> test chain with two validators and two full nodes.</p>
<h3 id="gitops-tooling"><a class="header" href="#gitops-tooling">GitOps Tooling</a></h3>
<p>Below are some useful GitOps tool for managing helm releases. Here is a list of tool from simplest to more advanced:</p>
<ul>
<li><a href="https://github.com/roboll/helmfile">Helmfile</a></li>
<li><a href="https://registry.terraform.io/providers/hashicorp/helm/latest/docs">Terraform Helm provider</a></li>
<li><a href="https://fluxcd.io/">Flux CD</a></li>
<li><a href="https://argo-cd.readthedocs.io/en/stable/">ArgoCD</a></li>
</ul>
<h2 id="important-chart-options"><a class="header" href="#important-chart-options">Important Chart Options:</a></h2>
<table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody>
<tr><td>node.chain</td><td>Network to connect to</td></tr>
<tr><td>node.command</td><td>Binary to use</td></tr>
<tr><td>node.flags</td><td>Flags to use with binary in container</td></tr>
<tr><td>node.customChainspecUrl</td><td>Custon Chainspec URL</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testnet-manager"><a class="header" href="#testnet-manager">Testnet Manager</a></h1>
<p>The <a href="https://github.com/paritytech/testnet-manager">Testnet manager</a> (<a href="https://github.com/paritytech/helm-charts/tree/main/charts/testnet-manager">helm chart</a>) lets you dynamically control test networks via a simple UI or API. It gives you a single pane of glass to list, inspect and interact with the nodes (full nodes, validators and parachain collators) running in a given Kubernetes namespace.</p>
<h2 id="rococo-example-view"><a class="header" href="#rococo-example-view">Rococo Example View</a></h2>
<h3 id="list-parachains"><a class="header" href="#list-parachains">List Parachains</a></h3>
<p><img src="kubernetes/../images/rococo-parachains.png" alt="rococo-parachains" /></p>
<h3 id="list-parachain-collators"><a class="header" href="#list-parachain-collators">List Parachain Collators</a></h3>
<p><img src="kubernetes/../images/rococo-collators-1002.png" alt="rococo-collators-1002" /></p>
<h3 id="inspect-validator-node"><a class="header" href="#inspect-validator-node">Inspect Validator Node</a></h3>
<p><img src="kubernetes/../images/rococo-validator-a-node-0.png" alt="rococo-validator-a-node-0" /></p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<h3 id="requirements"><a class="header" href="#requirements">Requirements</a></h3>
<p>The testnet manager requires the chain Sudo seed phrase to perform management functions. Also some chain specific variables should be defined in a configmap, this can be added to the <code>values.yaml</code>:</p>
<pre><code class="language-yaml">configmap:
  WS_ENDPOINT: &quot;ws://rococo-alice-node-0.rococo:9944&quot;
  NODE_HTTP_PATTERN: &quot;http://NODE_NAME.rococo:9933&quot;
  NODE_WS_PATTERN: &quot;ws://NODE_NAME.rococo:9944&quot;
  HEALTHY_MIN_PEER_COUNT: &quot;1&quot;
  LOG_LEVEL: DEBUG

secret:
  SUDO_SEED: &quot;0xe5be9a5092b81bca64be81d212e7f2f9eba183bb7a90954f7b76361f6edb5c0a&quot; # Alice
  VALIDATORS_ROOT_SEED: &quot;test test test test test test test test test test test test&quot;
</code></pre>
<p>Then install the testnet manager and port forward a connection using the output of the install:</p>
<pre><code>helm repo add parity https://paritytech.github.io/helm-charts/
helm repo update
helm install testnet-mgr parity/testnet-manager --values values.yaml
</code></pre>
<h3 id="frontend-gui"><a class="header" href="#frontend-gui">Frontend GUI</a></h3>
<p>In the nodes section you can view all running nodes, their roles, chain, uptime, cli arguments and you can also view logs.</p>
<p><img src="kubernetes/../images/testnet-mgr.png" alt="testnet-mgr-frontend" /></p>
<h3 id="interact-with-api-via-frontend"><a class="header" href="#interact-with-api-via-frontend">Interact with API via Frontend</a></h3>
<p>It's possible to view the API calls and execute them via the GUI. The main functions are:</p>
<ul>
<li>Viewing nodes, validators, collators and parachains</li>
<li>Registering / de-registering validators and collators</li>
<li>Onboarding / off-boarding parachains</li>
<li>Rotating session keys</li>
</ul>
<p><img src="kubernetes/../images/testnet-mgr-api.png" alt="testnet-mgr-api" /></p>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<p>Register a new validator in the <code>StatefulSet</code> called <code>rococo-val-pool</code>:</p>
<pre><code>curl -X 'POST' \
  'http://localhost:8080/api/register_validators?statefulset=rococo-val-pool' \
  -H 'accept: application/json' \
  -d ''
</code></pre>
<p>Onboard Parachain id 1000:</p>
<pre><code>curl -X 'POST' \
'http://localhost:8080/api/onboard_parachain/1000' \
-H 'accept: application/json' \
-d ''
</code></pre>
<h3 id="how-does-it-work-"><a class="header" href="#how-does-it-work-">How does it work ?</a></h3>
<p>The testnet-manager is deployed in the same Kubernetes namespaces as nodes deployed with the <a href="https://github.com/paritytech/helm-charts/tree/main/charts/node">node helm-chart</a>. As node pods deployed with the chart are tagged with the appropriate labels (eg. chain name, para ID), the manager is able to query the Kubernetes API and list the running nodes for each network (relay-chain, parachains).</p>
<p>By combining this list of nodes with the on-chain state retrieved from RPC endpoints (eg. list of active validators accounts), the manager can automate node key setup (by interacting directly with each node RPC endpoint) and registration (by submitting sudo extrinsics). Behind the scenes, it uses a derivation formula for generating deterministic Validator/Collator accounts addresses: &quot;${VALIDATORS_ROOT_SEED}//${node-name}&quot;.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monitoring-overview"><a class="header" href="#monitoring-overview">Monitoring Overview</a></h1>
<p>We can generally split monitoring into two different areas:
‚Ä¢ On-chain monitoring - monitoring events on-chain, e.g. a transaction by a certain address, a validator set change etc‚Ä¶
‚Ä¢ On-host monitoring - this is monitoring the individual node, e.g. the current block height, amount of p2p connections, amount of free memory on the host itself.</p>
<h2 id="on-chain"><a class="header" href="#on-chain">On-Chain</a></h2>
<p>This type of monitoring will generally check onchain via RPC nodes to check the values / delays / timing of events. You would normally only need two of these instances for all hosts. It is a good idea to run your own RPC servers to service these in case there are issues with the public RPC nodes.
Some example applications that queries onchain information are <a href="https://gitlab.com/Polkabot/polkabot">polkabot</a> and <a href="https://github.com/paritytech/polkadot-basic-notification">polkadot-basic-notification</a>.</p>
<h2 id="on-host"><a class="header" href="#on-host">On-Host</a></h2>
<p>You should monitor each node that you run on the network. Polkadot/Substrate exposes a bunch of useful metrics on http://host:9615/metrics, with http://host:9615/ being a healthcheck. This endpoint will only be exposed on the local network interface by default but you can expose it on all interfaces with the <code>--prometheus-external</code> flag.</p>
<p>This outputs in a simple key - value format. However you can also include tags within the key. </p>
<p>Simple Value:</p>
<pre><code>polkadot_database_cache_bytes 0
</code></pre>
<p>Values with tags:</p>
<pre><code>susbtrate_block_height{status=&quot;best&quot;} 136
susbtrate_block_height{status=&quot;finalized&quot;} 133
</code></pre>
<p>As the metrics provided by this endpoints don't include hosts metrics (e.g. cpu, memory, bandwidth usage), it is recommended to complement it with the <a href="https://github.com/prometheus/node_exporter">prometheus node exporter</a> which needs to be installed on the same host.</p>
<h2 id="telemetry"><a class="header" href="#telemetry">Telemetry</a></h2>
<p>The telemetry server is used for real time information from nodes, showing information about their name, location, current best &amp; finalized blocks etc‚Ä¶ This gives you a useful dashboard to view the state of nodes.</p>
<p>The project is in the <a href="https://github.com/paritytech/substrate-telemetry">substrate-telemetry</a> github repo, a <a href="https://github.com/paritytech/helm-charts/tree/main/charts/substrate-telemetry">helm chart</a> is also available to allow easy kubernetes deployments.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="example-monitoring-stack"><a class="header" href="#example-monitoring-stack">Example Monitoring Stack</a></h1>
<p><img src="monitoring/../images/monitoring-stack.png" alt="monitoring stack" /></p>
<p>An example of a very common open source monitoring stack. There are various tools for each layer of the stack:</p>
<ul>
<li>Prometheus - A time series database which can hold large amounts of data that can be accessed very quickly. It scrapes data from your defined exporters and saves this data.</li>
<li>Grafana - Grafana allows you to query, visualize, and understand your metrics. Many example dashboards exist and it is easy to create new ones.</li>
<li>Alertmanager - Creates and routes alerts based on alert rules and metrics. Many provider plugins exist to send alerts via email / sms / telegram / pagerduty / victorops / slack / matrix etc...</li>
<li>Loki - A highly scalable log aggregation system that allows you to view and search logs from all your infrastruture in one place.</li>
<li>Exporter - A process that listens on a port and reports appliation specific metrics to prometheus when scraped. Lots of exporters exist and new ones are easy to write. It just requires you return data in the format of: `<key>: <value>' with labels being optional.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="prometheus"><a class="header" href="#prometheus">Prometheus</a></h2>
<p><strong>‚ÄúPrometheus, a Cloud Native Computing Foundation project, is a systems and service monitoring system. It collects metrics from configured targets at given intervals, evaluates rule expressions, displays the results, and can trigger alerts when specified conditions are observed.‚Äù</strong> - Prometheus Github Repository</p>
<p>Prometheus is the engine which drives our monitoring system. For our example we will mainly focus on two sections:</p>
<h3 id="targets"><a class="header" href="#targets">Targets</a></h3>
<p>Targets are a list of endpoints you want to scrape. The two main exporters we care about are for 1) polkadot/substrate and 2) the node-exporter. An example of scraping these on the IP address 1.1.1.1 would be:</p>
<pre><code class="language-yaml">scrape_configs:
- job_name: check blockchain node
  static_configs:
    - targets:
      - 1.1.1.1:9080 # promtail
      - 1.1.1.1:9100 # node exporter
      - 1.1.1.1:9615 # substrate node
</code></pre>
<h3 id="rules"><a class="header" href="#rules">Rules</a></h3>
<p>Now that you are gathering data from the host you can add rules that will trigger alerts. These are defined in the format: </p>
<pre><code class="language-yaml">  - alert: BlockProductionSlow
    annotations:
      message: 'Best block on instance {{ $labels.instance }} increases by
      less than 1 per minute for more than 3 minutes.'
    expr: increase(polkadot_block_height{status=&quot;best&quot;}[1m]) &lt; 1
    for: 3m
    labels:
      severity: warning
</code></pre>
<p>Here‚Äôs an <a href="https://github.com/ddorgan/substrate-alerting-rules/blob/main/alerting-rules.yaml">example</a> with some basic block production rules.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="grafana"><a class="header" href="#grafana">Grafana</a></h2>
<p>Grafana is where you can define dashboards to show the time series information that prometheus is collecting. You just need to ensure you add a datasource:</p>
<pre><code class="language-yaml">  datasources:
      - name: &quot;prometheus-prod&quot;
        type: prometheus
        access: proxy
        editable: false
        orgId: 1
        url: &quot;http://prometheus-prod.monitoring.svc.cluster.local&quot;
        version: 1
        jsonData:
          timeInterval: 30s

</code></pre>
<p>You can find <a href="https://grafana.com/grafana/dashboards/?search=polkadot">existing</a> polkadot dashboards at grafana.com -</p>
<p><img src="monitoring/../images/lb0gOx.png" alt="grafana example" /></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="alertmanager"><a class="header" href="#alertmanager">Alertmanager</a></h2>
<p>The final part of the monitoring stack will be how and where to alert if something does go wrong. For example you may want to send instant messages for warning alerts, but page somebody 24/7 for critical alerts.</p>
<p>Alertmanager has many modules for email / many IM formats with almost any output being supported. You can also use 3rd party providers like pagerduty or victorops and do very detailed management of oncall queues, schedules etc‚Ä¶</p>
<p>A simple alert for block production being slow would look like:</p>
<pre><code class="language-yaml">        - alert: BlockProductionSlow
          annotations:
            message: 'Best block on instance {{ $labels.instance }} increases by
        less than 1 per minute for more than 3 minutes.'
          expr: increase(substrate_block_height{status=&quot;best&quot;}[1m]) &lt; 1
          for: 3m
          labels:
            severity: warning
</code></pre>
<p>This will then be sent to the outbound path for the severity warning.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="loki-1"><a class="header" href="#loki-1">Loki</a></h2>
<p><strong>‚ÄúLoki is a horizontally scalable, highly available, multi-tenant log aggregation system inspired by Prometheus‚Äù</strong></p>
<p>Loki is used to aggregate logs from blockchain nodes, allowing the operator to see errors, patterns and be able to search through the logs from all hosts very easily. An agent called promtail is used to push logs to the central loki server.</p>
<p>Example promtail.yaml configuration to collect the logs of a node managed by systemd:</p>
<pre><code># promtail server config
server:
  http_listen_port: 9080
  grpc_listen_port: 0
  log_level: info
positions:
  filename: /var/lib/promtail/positions.yaml

# loki servers
clients:
  - url: http://loki.example.com/loki/api/v1/push
    backoff_config:
      min_period: 1m
      max_period: 1h
      max_retries: 10000

scrape_configs:
  - job_name: journald
    journal:
      max_age: 1m
      path: /var/log/journal
      labels:
        job: journald
    pipeline_stages:
      - match:
          selector: '{job=&quot;journald&quot;}'
          stages:
          - multiline:
              firstline: '^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}'
              max_lines: 2500
          - regex:
              expression: '(?P&lt;date&gt;\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3})\s+(?P&lt;level&gt;(TRACE|DEBUG|INFO|WARN|ERROR))\s+(?P&lt;worker&gt;([^\s]+))\s+(?P&lt;target&gt;[\w-]+):?:?(?P&lt;subtarget&gt;[\w-]+)?:[\s]?(?P&lt;chaintype&gt;\[[\w-]+\]+)?[\s]?(?P&lt;message&gt;.+)'
          - labels:
              level:
              target:
              subtarget:
          - metrics:
              log_lines_total:
                type: Counter
                Description: &quot;Total Number of Chain Logs&quot;
                prefix: &quot;promtail_chain_&quot;
                max_idle_duration: 24h
                config:
                  match_all: true
                  action: inc
      - match:
          selector: '{job=&quot;journald&quot;, level=&quot;ERROR&quot;}'
          stages:
          - multiline:
              firstline: '^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}'
              max_lines: 2500
          - metrics:
              log_lines_total:
                type: Counter
                Description: &quot;Total Number of Chain Error Logs&quot;
                prefix: &quot;promtail_chain_error_&quot;
                max_idle_duration: 24h
                config:
                  match_all: true
                  action: inc
      - match:
          selector: '{job=&quot;journald&quot;, level=~&quot;.+&quot;} |~ &quot;(?i)(panic)&quot;'
          stages:
          - multiline:
              firstline: '^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}'
              max_lines: 2500
          - metrics:
              log_lines_total:
                type: Counter
                Description: &quot;Total Number of Chain Panic Logs&quot;
                prefix: &quot;promtail_chain_panic_&quot;
                max_idle_duration: 24h
                config:
                  match_all: true
                  action: inc
    relabel_configs:
      - source_labels: ['__journal__systemd_unit']
        target_label: 'unit'
      - source_labels: ['unit']
        regex: '(.*.scope|user.*.service)'
        action: drop
      - source_labels: ['__journal__hostname']
        target_label: 'host'
      - action: replace
        source_labels:
        - __journal__cmdline
        - __journal__hostname
        separator: &quot;;&quot;
        regex: '.*--chain.*;(.*)'
        target_label: 'node'
        replacement: $1
</code></pre>
<p>The above example also configures the following custom metrics derived from logs <code>promtail_chain_log_lines_total</code>, <code>promtail_chain_error_log_lines_total</code> and  <code>promtail_chain_panic_log_lines_total</code> to be exposed on the promtail metrics endpoint (http://host:9080).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="keys-and-accounts"><a class="header" href="#keys-and-accounts">Keys And Accounts</a></h1>
<p>This page will describe some basic information on keys and accounts. For a more general and detailed explination see <a href="https://wiki.polkadot.network/docs/learn-accounts">learn accounts</a> on the polkadot wiki page.</p>
<h2 id="encryption-schemes"><a class="header" href="#encryption-schemes">Encryption Schemes</a></h2>
<table><thead><tr><th>Name</th><th>Type</th></tr></thead><tbody>
<tr><td>ed25519</td><td>The vanilla ed25519 implementation using Schnorr signatures.</td></tr>
<tr><td>sr25519</td><td>The Schnorrkel/Ristretto sr25519 variant using Schnorr signatures. (default)</td></tr>
<tr><td>ecdsa</td><td>ECDSA signatures on secp256k1</td></tr>
</tbody></table>
<h2 id="session-key-types"><a class="header" href="#session-key-types">Session Key Types</a></h2>
<table><thead><tr><th>Name</th><th>Type</th></tr></thead><tbody>
<tr><td>grandpa</td><td>ed25519</td></tr>
<tr><td>babe</td><td>sr25519</td></tr>
<tr><td>im_online</td><td>sr25519</td></tr>
<tr><td>para_validator</td><td>sr25519</td></tr>
<tr><td>para_assignment</td><td>sr25519</td></tr>
<tr><td>authority_discovery</td><td>sr25519</td></tr>
<tr><td>beefy</td><td>ecdsa</td></tr>
</tbody></table>
<h2 id="key-generation-and-inspection"><a class="header" href="#key-generation-and-inspection">Key Generation and Inspection</a></h2>
<p>You can use <code>polkadot keys</code> or the <code>subkey</code> command to generate and inspect keys. </p>
<p>Two important subcommands are:</p>
<ul>
<li><code>generate</code>  Create a new random account and print the private key data or save to a file. </li>
<li><code>inspect</code> View the account data for an account by passing a secret phrase or seed. </li>
</ul>
<p>Some important options are:</p>
<ul>
<li><code>--network</code> specify the network the keys will be used on, default is substrate.</li>
<li><code>--scheme</code> the scheme for the keys, default is sr25519.</li>
</ul>
<h2 id="generate"><a class="header" href="#generate">Generate</a></h2>
<p><strong>Create Polkadot Random Key</strong>:</p>
<pre><code>$ polkadot key generate -n polkadot
Secret phrase:       settle whisper usual blast device source region pumpkin ugly beyond promote cluster
  Network ID:        polkadot
  Secret seed:       0x2e6371e04b45f16cd5c2d66fc47c8ad7f2881215287c374abfa0e07fd003cb01
  Public key (hex):  0x9e65e97bd8ba80095440a68d1be71adff107c73627c8b85d29669721e02e2b24
  Account ID:        0x9e65e97bd8ba80095440a68d1be71adff107c73627c8b85d29669721e02e2b24
  Public key (SS58): 14agqii5GAiM5z4yzGhJdyWQ3a6HeY2oXvLdCrdhFXRnQ77D
  SS58 Address:      14agqii5GAiM5z4yzGhJdyWQ3a6HeY2oXvLdCrdhFXRnQ77D
</code></pre>
<h2 id="inspection"><a class="header" href="#inspection">Inspection</a></h2>
<p><strong>Inspect Created Key</strong>:</p>
<pre><code>$ ./polkadot key inspect -n polkadot &quot;settle whisper usual blast device source region pumpkin ugly beyond promote cluster&quot; 
Secret phrase:       settle whisper usual blast device source region pumpkin ugly beyond promote cluster
  Network ID:        polkadot
  Secret seed:       0x2e6371e04b45f16cd5c2d66fc47c8ad7f2881215287c374abfa0e07fd003cb01
  Public key (hex):  0x9e65e97bd8ba80095440a68d1be71adff107c73627c8b85d29669721e02e2b24
  Account ID:        0x9e65e97bd8ba80095440a68d1be71adff107c73627c8b85d29669721e02e2b24
  Public key (SS58): 14agqii5GAiM5z4yzGhJdyWQ3a6HeY2oXvLdCrdhFXRnQ77D
  SS58 Address:      14agqii5GAiM5z4yzGhJdyWQ3a6HeY2oXvLdCrdhFXRnQ77D
</code></pre>
<p><strong>Inspect Created Key With Hard Derivation //Stash//0</strong>:</p>
<pre><code>$ polkadot key inspect -n polkadot &quot;settle whisper usual blast device source region pumpkin ugly beyond promote cluster//Stash//0&quot; 
Secret Key URI `settle whisper usual blast device source region pumpkin ugly beyond promote cluster//Stash//0` is account:
  Network ID:        polkadot 
 Secret seed:       0xe9437b365161e8228e8abd53d64e6b31058dcddcd0b96f895045ecc41579ee3e
  Public key (hex):  0xd8ed7b942f6e590b06e99951ac10e3312f65f01df5b3f250b70374fc2da1046d
  Account ID:        0xd8ed7b942f6e590b06e99951ac10e3312f65f01df5b3f250b70374fc2da1046d
  Public key (SS58): 15uRtdeE4MyMHV9LP1UHKqTx4f8Qa8uVZUpxWWw8VKSroucK
  SS58 Address:      15uRtdeE4MyMHV9LP1UHKqTx4f8Qa8uVZUpxWWw8VKSroucK
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="custom-chain"><a class="header" href="#custom-chain">Custom Chain</a></h1>
<p>This section will explain what is required to build a custom chain spec for your own dev network.</p>
<h2 id="create-chain-spec"><a class="header" href="#create-chain-spec">Create Chain Spec</a></h2>
<p>Create a non-raw chainspec for your network with:</p>
<pre><code class="language-bash">
./binary build-spec ‚Äìchain chain-name --disable-default-bootnode &gt; custom-chainspec.json

</code></pre>
<p><strong>Important Fields</strong>:</p>
<table><thead><tr><th>Field</th><th>Purpose</th></tr></thead><tbody>
<tr><td>Name</td><td>Name of the network</td></tr>
<tr><td>id</td><td>Id of network, also used for the filesystem path</td></tr>
<tr><td>bootNodes</td><td>List of multiaddr‚Äôs of bootnodes for the network</td></tr>
<tr><td>telemetryEndpoints</td><td>List of telemetry endpoints to contact by default</td></tr>
<tr><td>staking.stakers</td><td>List of initial validators</td></tr>
<tr><td>session.keys</td><td>List of initial session keys for validators</td></tr>
</tbody></table>
<p>Once the values have been updated this chainspec should be converted in raw format using the command:</p>
<pre><code class="language-bash">
polkadot  build-spec ‚Äìchain custom-chainspec.json ‚Äìraw &gt; custom-chainspec-raw.json

</code></pre>
<h2 id="inject-initial-validator-keys"><a class="header" href="#inject-initial-validator-keys">Inject initial validator keys</a></h2>
<p>There are two main ways to inject the initial validator keys:</p>
<h3 id="cli"><a class="header" href="#cli">CLI</a></h3>
<p>Example to insert one ed25519 and one sr25519 key.</p>
<pre><code class="language-bash">polkadot key insert -d &lt;my_chain_folder&gt; --key-type gran --scheme ed25519 --suri &lt;my_key_suri&gt;
polkadot key insert -d &lt;my_chain_folder&gt; --key-type babe --scheme sr25519 --suri &lt;my_key_suri&gt;

</code></pre>
<h3 id="rpc"><a class="header" href="#rpc">RPC</a></h3>
<p>Example to inject key via RPC, edit the KEY_TYPE sand KEY_SEED:</p>
<pre><code class="language-bash">
curl -H &quot;Content-Type: application/json&quot; \ --data '{ &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;author_insertKey&quot;, &quot;params&quot;:[&quot;'&quot;${KEY_TYPE}&quot;'&quot;, &quot;'&quot;${KEY_SEED}&quot;'&quot;],&quot;id&quot;:1 }' http://localhost:9933

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infrastructure-tooling"><a class="header" href="#infrastructure-tooling">Infrastructure Tooling</a></h1>
<p>This section is for listing some useful projects and tools that are releavant for node operators and developers. A community maintained <a href="https://github.com/substrate-developer-hub/awesome-substrate">Awesome Substrate</a> is a more detailed general list.</p>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<table><thead><tr><th>Project</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/paritytech/zombienet">Zombienet</a></td><td>A great tool for deploying test setups. Providers include native, podman and kubernetes. Also supports running automated tests against these networks</td></tr>
<tr><td><a href="https://github.com/paritytech/smart-bench">smart bench</a></td><td>Smart contracts benchmarking on Substrate</td></tr>
</tbody></table>
<h2 id="frontends"><a class="header" href="#frontends">Frontends</a></h2>
<table><thead><tr><th>Project</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/polkadot-js/apps">polkadot-js frontend</a></td><td>Github repo for [https://polkadot.js.org/apps/] - commonly used application for interacting with substrate and polkadot based chains</td></tr>
<tr><td><a href="https://github.com/paritytech/polkadot-staking-dashboard">Staking Dashbord</a></td><td>A sleek <a href="https://staking.polkadot.network/dashboard">staking dashboard</a> using react and the polkadot-js library</td></tr>
<tr><td><a href="https://github.com/paritytech/contracts-ui">contracts-ui</a></td><td>Web application for deploying wasm smart contracts on Substrate chains that include the FRAME contracts pallet</td></tr>
<tr><td><a href="https://github.com/polkadot-js/common/blob/master/test-bundle.html">Example polkadot-js-bundle</a></td><td>Use polkadot javascript bundles to write custom frontends</td></tr>
</tbody></table>
<h2 id="indexing-chain-data"><a class="header" href="#indexing-chain-data">Indexing Chain Data</a></h2>
<table><thead><tr><th>Project</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/paritytech/substrate-archive.git">substrate archive</a></td><td>Blockchain indexing engine using PostgreSql</td></tr>
<tr><td><a href="https://github.com/subsquid/squid">Subsquid</a></td><td>Blockchain indexing engine using GraphQL</td></tr>
</tbody></table>
<h2 id="cli-utilities"><a class="header" href="#cli-utilities">CLI Utilities</a></h2>
<table><thead><tr><th>Project</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/paritytech/substrate/tree/master/bin/utils/subkey">Subkey</a></td><td>Used for generating and restoring keys. Works with multiple networks and key schemes</td></tr>
<tr><td><a href="https://github.com/polkadot-js/tools">polkadot-js-tools</a></td><td>A very flexible utility for executing API calls or running queries.</td></tr>
<tr><td><a href="https://github.com/paritytech/subxt">Subxt</a></td><td>Submits extrinsics via RPC</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="polkadot-js-tools"><a class="header" href="#polkadot-js-tools">Polkadot Js Tools</a></h1>
<p><a href="https://github.com/polkadot-js/tools">Polkadot Js Tools</a> is an amazing tool for interacting with substrate based chains. </p>
<p>A full list of possible <a href="https://polkadot.js.org/docs/substrate/rpc/">rpc</a> calls and <a href="https://polkadot.js.org/docs/substrate/extrinsics">extrinsics</a> are available from the <a href="https://polkadot.js.org/docs/substrate/">polkadot js docs</a> page.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<ul>
<li>
<p><a href="https://github.com/polkadot-js/tools/tree/master/packages/api-cli">api-cli</a> A cli tool to allow you to make API calls to any running node</p>
</li>
<li>
<p><a href="https://github.com/polkadot-js/tools/blob/master/packages/json-serve">json-serve</a> A server that serves JSON outputs for specific queries</p>
</li>
<li>
<p><a href="https://github.com/polkadot-js/tools/blob/master/packages/monitor-rpc">monitor-rpc</a> A simple monitoring interface that checks the health of a remote node via RPC</p>
</li>
<li>
<p><a href="https://github.com/polkadot-js/tools/blob/master/packages/signer-cli">signer-cli</a> A cli tool that allows you to generate transactions in one terminal and sign them in another terminal (or computer)</p>
</li>
<li>
<p><a href="https://github.com/polkadot-js/tools/blob/master/packages/vanitygen">vanitygen</a> Generate vanity addresses, matching some pattern</p>
</li>
</ul>
<h3 id="install"><a class="header" href="#install">Install</a></h3>
<p>Steps:</p>
<ul>
<li>
<p>Clone repo: <code>git clone https://github.com/polkadot-js/tools.git</code></p>
</li>
<li>
<p>Install dependencies and build: <code>yarn install &amp;&amp; yarn build</code></p>
</li>
</ul>
<h3 id="example-chain-queries"><a class="header" href="#example-chain-queries">Example Chain Queries</a></h3>
<p>Display block information (parent hash, block number, state root etc..) for last block:</p>
<pre><code>yarn run:api query.chain.getHeader
</code></pre>
<p>Get the balance for the account <code>//Alice</code>:</p>
<pre><code>yarn run:api query.system.account 15oF4uVJwmo4TdGW7VfQxNLavjCXviqxT9S1MgbjMNHr6Sp5
</code></pre>
<p>Display all RPC methods available:</p>
<pre><code>yarn run:api rpc.rpc.methods
</code></pre>
<h3 id="example-chain-transactionsextrinsics"><a class="header" href="#example-chain-transactionsextrinsics">Example Chain Transactions/Extrinsics</a></h3>
<p>Simple transfer of 1 unit <code>//Alice</code> to <code>//Bob</code> on the same chain. Using <code>--seed</code> as the sender for signing the transactions:</p>
<pre><code>yarn run:api tx.balances.transfer 5FHneW46xGXgs5mUiveU4sbTyGBzmstUspZC92UhjJM694ty 10000000000 --seed &quot;//Alice&quot;
</code></pre>
<p>Transfer 1.23 units from <code>//Alice</code> on the relay chain to <code>//Charlie</code> on the parachain <code>1000</code>:</p>
<pre><code>yarn run:api tx.xcmPallet.limitedTeleportAssets '{&quot;v1&quot;:{&quot;parents&quot;:0,&quot;interior&quot;:{&quot;x1&quot;:{&quot;parachain&quot;:1000}}}}' '{&quot;v1&quot;:{&quot;parents&quot;:0,&quot;interior&quot;:{&quot;x1&quot;:{&quot;AccountId32&quot;: {&quot;id&quot;: &quot;0x90b5ab205c6974c9ea841be688864633dc9ca8a357843eeacf2314649965fe22&quot;, &quot;network&quot;: &quot;Any&quot;}}}}}' '{&quot;v1&quot;: [ {&quot;id&quot;: { &quot;Concrete&quot;: {&quot;parents&quot;:0, &quot;interior&quot;:&quot;Here&quot; }}, &quot;Fun&quot;: { &quot;Fungible&quot;: &quot;12300000000&quot;}}]}'  0 Unlimited  --seed &quot;//Alice&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="helmfile"><a class="header" href="#helmfile">Helmfile</a></h1>
<p>Below are two examples of helmfile in action. One a simple single helmfile for testing and the second a more realistic example to be used in production.</p>
<h3 id="basic-helmfile-example"><a class="header" href="#basic-helmfile-example">Basic helmfile example</a></h3>
<p>This is a  very simple one file example of a helmfile to deploy two <code>rococo-local</code> relaychain validators along with two parachains <code>statemint-dev</code> and <code>contracts-rococo-dev</code>. It is intended for basic testing and familiarisation of helmfile. </p>
<p>A more more real world example is listed below which comes from the <code>testnet-manager</code> repo. An nginx contrainer will also be deployed to host chain spec files.</p>
<p>Steps:</p>
<ul>
<li>
<p>Create a helmfile based on the <a href="examples/helmfile.html#basic_helmfile">simple example</a> below and name it helmfile.yaml</p>
</li>
<li>
<p>Install a webserver to host helmfiles using <code>kubectl create -f https://raw.githubusercontent.com/paritytech/testnet-manager/main/local-kubernetes/kube-setup/validators-chainspec.yml</code></p>
</li>
<li>
<p>Add relaychain and parachains using: <code>helmfile sync</code></p>
</li>
</ul>
<h3 id="real-world-helmfile-example"><a class="header" href="#real-world-helmfile-example">Real world helmfile example</a></h3>
<p>You can find a good reference helmfile example at the testnet-manager <a href="https://github.com/paritytech/testnet-manager/tree/main/local-kubernetes/charts">examples</a> folder.</p>
<h3 id="basic_helmfile"><a class="header" href="#basic_helmfile">Basic_helmfile</a></h3>
<pre><code>repositories:
  - name: parity
    url: https://paritytech.github.io/helm-charts/

helmDefaults:
  createNamespace: false
  waitForJobs: true

releases:
## relay chain Rococo ##
  - name: validator-alice
    namespace: rococo
    chart: parity/node
    version: 2.11.4
    values:
      - node:
          chain: rococo-local
          replicas: 1
          customChainspecUrl: &quot;http://chainspec.rococo/rococo-local.json&quot;
          role: authority
          flags:
            - &quot;--alice&quot;
            - &quot;--unsafe-rpc-external&quot;
            - &quot;--unsafe-ws-external&quot;
            - &quot;--rpc-methods=unsafe&quot;
            - &quot;--rpc-cors=all&quot;
            - &quot;--node-key 0x91cb59d86820419075b08e3043cd802ba3506388d8b161d2d4acd203af5194c1&quot;
        storageClass: standard
        extraLabels:
          validatorAccount: &quot;5GNJqTPyNqANBkUVMN1LPPrxXnFouWXoe2wNSmmEoLctxiZY&quot; # Alice address
          ss58Format: &quot;0&quot;
  - name: validator-bob
    namespace: rococo
    chart: parity/node
    version: 2.11.4
    values:
      - node:
          chain: rococo-local
          customChainspecUrl: &quot;http://chainspec.rococo/rococo-local.json&quot;
          role: authority
          replicas: 1
          flags:
            - &quot;--bob&quot;
            - &quot;--unsafe-rpc-external&quot;
            - &quot;--unsafe-ws-external&quot;
            - &quot;--rpc-methods=unsafe&quot;
            - &quot;--rpc-cors=all&quot;
        storageClass: standard
        extraLabels:
          validatorAccount: &quot;5HpG9w8EBLe5XCrbczpwq5TSXvedjrBGCwqxK1iQ7qUsSWFc&quot; # Bob address
          ss58Format: &quot;0&quot;

## Para chain Statemint ##
  - name: statemint-alice
    namespace: rococo
    chart: parity/node
    version: 2.11.4
    values:
      - image:
          repository: &quot;parity/polkadot-parachain&quot;
          tag: &quot;latest&quot;
      - node:
          chain: statemint-dev
          role: collator
          command: &quot;/usr/local/bin/polkadot-parachain&quot;
          collator:
            isParachain: true
            relayChainFlags: &quot;--execution wasm --bootnodes /dns4/validator-alice-node-0/tcp/30333/p2p/12D3KooWMeR4iQLRBNq87ViDf9W7f6cc9ydAPJgmq48rAH116WoC&quot;
            relayChainCustomChainspecUrl: &quot;http://chainspec.rococo/rococo-local.json&quot;
          flags:
            - &quot;--alice&quot;
            - &quot;--unsafe-rpc-external&quot;
            - &quot;--unsafe-ws-external&quot;
            - &quot;--rpc-methods=unsafe&quot;
            - &quot;--rpc-cors=all&quot;
            - &quot;--force-authoring&quot;
            - &quot;--pruning=archive&quot;
        storageClass: standard
        extraLabels:
          paraId: &quot;1000&quot;
          ss58Format: &quot;0&quot;

## Para chain contracts rococo
  - name: contracts-alice
    namespace: rococo
    chart: parity/node
    version: 2.11.4
    values:
      - image:
          repository: &quot;parity/polkadot-parachain&quot;
          tag: &quot;latest&quot;
      - node:
          chain: contracts-rococo-dev
          role: collator
          command: &quot;/usr/local/bin/polkadot-parachain&quot;
          collator:
            isParachain: true
            relayChainFlags: &quot;--execution wasm --bootnodes /dns4/validator-alice-node-0/tcp/30333/p2p/12D3KooWMeR4iQLRBNq87ViDf9W7f6cc9ydAPJgmq48rAH116WoC&quot;
            relayChainCustomChainspecUrl: &quot;http://chainspec.rococo/rococo-local.json&quot;
          flags:
            - &quot;--alice&quot;
            - &quot;--unsafe-rpc-external&quot;
            - &quot;--unsafe-ws-external&quot;
            - &quot;--rpc-methods=unsafe&quot;
            - &quot;--rpc-cors=all&quot;
            - &quot;--force-authoring&quot;
            - &quot;--pruning=archive&quot;
        storageClass: standard
        extraLabels:
          paraId: &quot;1002&quot;
          ss58Format: &quot;0&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zombienet"><a class="header" href="#zombienet">Zombienet</a></h1>
<p>Below is an example that is similar to the helmfile example. It will deploy two <code>rococo-local</code> relaychain validators and two parachains <code>statemint-dev</code> and <code>contracts-rococo-dev</code> and also HRMP channels between parachains 1000 and 1002.</p>
<h3 id="more-information"><a class="header" href="#more-information">More Information</a></h3>
<p>For more information see the <a href="https://paritytech.github.io/zombienet/">Zombienet manual</a>. For more examples see the <a href="https://github.com/paritytech/zombienet/tree/main/examples">Zomebienet examples</a> in the Zombienet repo.</p>
<h3 id="steps"><a class="header" href="#steps">Steps</a></h3>
<ul>
<li>
<p>Clone the zombienet repo: <code>git@github.com:paritytech/zombienet.git</code></p>
</li>
<li>
<p>Build zomebienet using: <code>npm install &amp;&amp; npm run build</code></p>
</li>
<li>
<p>Create a new config file based on the <a href="examples/zombienet.html#zombienet_example">zombienet_example config</a></p>
</li>
<li>
<p>Deploy this to k8s using the command: <code>node cli/dist.js spawn path/configfile.yaml</code></p>
</li>
</ul>
<h3 id="zombienet_example"><a class="header" href="#zombienet_example">Zombienet_example</a></h3>
<pre><code>relaychain]
default_image = &quot;docker.io/paritypr/polkadot-debug:master&quot;
default_command = &quot;polkadot&quot;
default_args = [ &quot;-lparachain=debug&quot; ]

chain = &quot;rococo-local&quot;

  [[relaychain.nodes]]
  name = &quot;alice&quot;
  validator = true

  [[relaychain.nodes]]
  name = &quot;bob&quot;
  validator = true

[[parachains]]
id = 1000
cumulus_based = true
chain = &quot;statemint-dev&quot;

  [parachains.collator]
  name = &quot;statemint-collator&quot;
  image = &quot;docker.io/parity/polkadot-parachain:latest&quot;
  command = &quot;polkadot-parachain&quot;
  args = [&quot;-lparachain=debug&quot;]

[[parachains]]
id = 1002
cumulus_based = true
chain = &quot;contracts-rococo-dev&quot;

  [parachains.collator]
  name = &quot;contracts-collator&quot;
  image = &quot;docker.io/parity/polkadot-parachain:latest&quot;
  command = &quot;polkadot-parachain&quot;
  args = [&quot;-lparachain=debug&quot;]

[[hrmpChannels]]
sender = 1000
recipient = 1002
maxCapacity = 4
maxMessageSize = 512

[[hrmpChannels]]
sender = 1002 
recipient = 1000 
maxCapacity = 4
maxMessageSize = 512
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
